# é£ä¹¦æ–‡æ¡£APIæ¥å£æ–‡æ¡£æ€»è§ˆ

æœ¬æ–‡æ¡£ç›®å½•åŒ…å«äº†Obsidianåˆ°é£ä¹¦çŸ¥è¯†åº“åŒæ­¥å·¥å…·æ‰€éœ€çš„æ ¸å¿ƒé£ä¹¦APIæ¥å£æ–‡æ¡£ã€‚

## ğŸ“‹ APIæ¥å£åˆ—è¡¨

### æ ¸å¿ƒæ–‡æ¡£æ“ä½œæ¥å£

| åºå· | æ¥å£åç§° | æ–‡ä»¶ | åŠŸèƒ½æè¿° | ä½¿ç”¨åœºæ™¯ |
|------|----------|------|----------|----------|
| 01 | åˆ›å»ºé£ä¹¦æ–‡æ¡£ | [01-create-document.md](./01-create-document.md) | åˆ›å»ºæ–°çš„é£ä¹¦æ–‡æ¡£ | ä¸ºæ¯ä¸ªObsidianç¬”è®°åˆ›å»ºå¯¹åº”çš„é£ä¹¦æ–‡æ¡£ |
| 02 | è·å–æ–‡æ¡£åŸºæœ¬ä¿¡æ¯ | [02-get-document-info.md](./02-get-document-info.md) | è·å–æ–‡æ¡£æ ‡é¢˜ã€ç‰ˆæœ¬å·ç­‰åŸºæœ¬ä¿¡æ¯ | åŒæ­¥å‰çš„çŠ¶æ€æ£€æŸ¥ã€ç‰ˆæœ¬æ§åˆ¶ |
| 03 | è·å–æ–‡æ¡£æ‰€æœ‰å—å†…å®¹ | [03-get-document-blocks.md](./03-get-document-blocks.md) | è·å–æ–‡æ¡£çš„å®Œæ•´å—ç»“æ„å’Œå†…å®¹ | å¢é‡åŒæ­¥çš„å†…å®¹æ¯”è¾ƒ |

### å†…å®¹ç¼–è¾‘æ¥å£

| åºå· | æ¥å£åç§° | æ–‡ä»¶ | åŠŸèƒ½æè¿° | ä½¿ç”¨åœºæ™¯ |
|------|----------|------|----------|----------|
| 04 | åˆ›å»ºå­å—å†…å®¹ | [04-create-child-blocks.md](./04-create-child-blocks.md) | åœ¨æ–‡æ¡£ä¸­æ’å…¥æ–°çš„å†…å®¹å— | åŒæ­¥Obsidianç¬”è®°å†…å®¹åˆ°é£ä¹¦ |
| 05 | æ›´æ–°ç‰¹å®šå—å†…å®¹ | [05-update-block.md](./05-update-block.md) | æ›´æ–°å•ä¸ªå—çš„å†…å®¹å’Œæ ·å¼ | å†…å®¹å˜æ›´çš„å¢é‡åŒæ­¥ |
| 06 | æ‰¹é‡æ›´æ–°æ–‡æ¡£å— | [06-batch-update-blocks.md](./06-batch-update-blocks.md) | ä¸€æ¬¡æ€§æ›´æ–°å¤šä¸ªå—çš„å†…å®¹ | æé«˜åŒæ­¥æ•ˆç‡ï¼Œæ‰¹é‡å¤„ç† |
| 07 | åˆ é™¤æ–‡æ¡£å— | [07-delete-blocks.md](./07-delete-blocks.md) | åˆ é™¤æŒ‡å®šèŒƒå›´çš„å—å†…å®¹ | æ¸…ç©ºæ–‡æ¡£é‡æ–°åŒæ­¥ |

## ğŸ”„ å…¸å‹åŒæ­¥æµç¨‹

### æ–°å»ºæ–‡æ¡£åŒæ­¥æµç¨‹
```mermaid
graph TD
    A[æ‰«æObsidianç¬”è®°] --> B[åˆ›å»ºé£ä¹¦æ–‡æ¡£]
    B --> C[è§£æMarkdownå†…å®¹]
    C --> D[è½¬æ¢ä¸ºé£ä¹¦Blockæ ¼å¼]
    D --> E[æ‰¹é‡åˆ›å»ºå­å—å†…å®¹]
    E --> F[åŒæ­¥å®Œæˆ]
```

### å¢é‡æ›´æ–°åŒæ­¥æµç¨‹
```mermaid
graph TD
    A[æ£€æµ‹Obsidianç¬”è®°å˜æ›´] --> B[è·å–å¯¹åº”é£ä¹¦æ–‡æ¡£ä¿¡æ¯]
    B --> C[è·å–ç°æœ‰æ–‡æ¡£å†…å®¹]
    C --> D[æ¯”è¾ƒå†…å®¹å·®å¼‚]
    D --> E{æ˜¯å¦æœ‰å˜æ›´?}
    E -->|æ˜¯| F[æ‰¹é‡æ›´æ–°å˜æ›´çš„å—]
    E -->|å¦| G[è·³è¿‡åŒæ­¥]
    F --> H[åŒæ­¥å®Œæˆ]
```

## ğŸ› ï¸ APIä½¿ç”¨æœ€ä½³å®è·µ

### 1. è®¤è¯ç®¡ç†
- ä½¿ç”¨Bearer Tokenè®¤è¯ï¼š`Authorization: Bearer {access_token}`
- ç¡®ä¿tokençš„æœ‰æ•ˆæœŸç®¡ç†
- å»ºè®®ä½¿ç”¨ä¼ä¸šè‡ªå»ºåº”ç”¨è·å–tenant_access_token

### 2. é”™è¯¯å¤„ç†
- æ£€æŸ¥HTTPçŠ¶æ€ç å’Œå“åº”ä½“ä¸­çš„codeå­—æ®µ
- å®ç°æŒ‡æ•°é€€é¿é‡è¯•æœºåˆ¶
- å¤„ç†APIé™æµï¼ˆ429çŠ¶æ€ç ï¼‰

### 3. æ€§èƒ½ä¼˜åŒ–
- ä¼˜å…ˆä½¿ç”¨æ‰¹é‡æ“ä½œæ¥å£ï¼ˆå¦‚æ‰¹é‡æ›´æ–°å—ï¼‰
- åˆç†è®¾ç½®åˆ†é¡µå¤§å°ï¼ˆpage_sizeï¼‰
- ä½¿ç”¨document_revision_idè¿›è¡Œç‰ˆæœ¬æ§åˆ¶

### 4. æ•°æ®ä¸€è‡´æ€§
- è·å–æœ€æ–°çš„revision_idå†è¿›è¡Œæ›´æ–°æ“ä½œ
- ä½¿ç”¨äº‹åŠ¡æ€§çš„æ‰¹é‡æ“ä½œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- å®ç°å¹‚ç­‰æ€§æ“ä½œï¼Œé¿å…é‡å¤åŒæ­¥

## ğŸ“Š Blockç±»å‹æ˜ å°„è¡¨

| Markdownå…ƒç´  | é£ä¹¦Blockç±»å‹ | block_typeå€¼ | è¯´æ˜ |
|--------------|---------------|--------------|------|
| # æ ‡é¢˜1 | heading1 | 1 | H1æ ‡é¢˜ |
| ## æ ‡é¢˜2 | heading2 | 3 | H2æ ‡é¢˜ |
| ### æ ‡é¢˜3 | heading3 | 4 | H3æ ‡é¢˜ |
| æ™®é€šæ®µè½ | text | 2 | æ–‡æœ¬æ®µè½ |
| - æ— åºåˆ—è¡¨ | bullet | 8 | é¡¹ç›®ç¬¦å·åˆ—è¡¨ |
| 1. æœ‰åºåˆ—è¡¨ | ordered | 9 | ç¼–å·åˆ—è¡¨ |
| ```ä»£ç å—``` | code | 10 | ä»£ç å— |
| > å¼•ç”¨ | quote | 11 | å¼•ç”¨å— |
| è¡¨æ ¼ | table | table | è¡¨æ ¼ |

## ğŸ”§ å¸¸ç”¨ä»£ç ç‰‡æ®µ

### Pythonç¤ºä¾‹ - åŸºç¡€APIè°ƒç”¨
```python
import requests

def call_feishu_api(method, url, headers=None, data=None):
    """é£ä¹¦APIè°ƒç”¨çš„åŸºç¡€å°è£…"""
    default_headers = {
        'Authorization': f'Bearer {access_token}',
        'Content-Type': 'application/json'
    }
    if headers:
        default_headers.update(headers)
    
    response = requests.request(method, url, headers=default_headers, json=data)
    return response.json()

# åˆ›å»ºæ–‡æ¡£
def create_document(folder_token=None):
    url = 'https://open.feishu.cn/open-apis/docx/v1/documents'
    if folder_token:
        url += f'?folder_token={folder_token}'
    return call_feishu_api('POST', url)

# è·å–æ–‡æ¡£ä¿¡æ¯
def get_document_info(document_id):
    url = f'https://open.feishu.cn/open-apis/docx/v1/documents/{document_id}'
    return call_feishu_api('GET', url)
```

## ğŸ“ æ³¨æ„äº‹é¡¹

### APIé™åˆ¶
- å•æ¬¡æ‰¹é‡æ“ä½œæœ€å¤š100ä¸ªå—
- åˆ†é¡µæŸ¥è¯¢æœ€å¤§page_sizeä¸º500
- APIæœ‰QPSé™åˆ¶ï¼Œæ³¨æ„æ§åˆ¶è°ƒç”¨é¢‘ç‡

### æ•°æ®æ ¼å¼
- æ‰€æœ‰æ–‡æœ¬å†…å®¹ä½¿ç”¨UTF-8ç¼–ç 
- å›¾ç‰‡é“¾æ¥å¿…é¡»æ˜¯å¯è®¿é—®çš„HTTP/HTTPS URL
- æ—¶é—´æˆ³ä½¿ç”¨Unixæ¯«ç§’æ ¼å¼

### æƒé™è¦æ±‚
- éœ€è¦åº”ç”¨å…·å¤‡çŸ¥è¯†åº“è¯»å†™æƒé™
- æ–‡æ¡£æ“ä½œéœ€è¦å¯¹åº”çš„æ–‡æ¡£è®¿é—®æƒé™
- å»ºè®®ä½¿ç”¨ä¼ä¸šè‡ªå»ºåº”ç”¨ä»¥è·å¾—æ›´å¥½çš„æƒé™æ§åˆ¶

---

## ğŸ”— ç›¸å…³é“¾æ¥

- [é£ä¹¦å¼€æ”¾å¹³å°å®˜ç½‘](https://open.feishu.cn/)
- [é£ä¹¦APIå®˜æ–¹æ–‡æ¡£](https://open.feishu.cn/document/)
- [Context7é£ä¹¦APIå‚è€ƒ](https://github.com/jasonqwj/feishu_api_docs)

---

*æœ€åæ›´æ–°æ—¶é—´: 2024å¹´12æœˆ* 